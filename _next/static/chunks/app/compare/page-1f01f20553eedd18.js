(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[402],{4223:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>T});var r=a(5155),s=a(2115);let i={primary:"bg-green-main text-white hover:bg-green-light focus:ring-green-main",secondary:"bg-green-light text-white hover:bg-green-main focus:ring-green-light",outline:"border-2 border-grey-medium text-brand-black hover:bg-card-bg dark:text-white dark:hover:bg-grey-dark/30",ghost:"text-brand-black hover:bg-card-bg dark:text-white dark:hover:bg-grey-dark/30",danger:"bg-status-error text-white hover:bg-status-error/90 focus:ring-status-error"},n={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"},l=(0,s.forwardRef)((e,t)=>{let{className:a="",variant:s="primary",size:l="md",isLoading:c,disabled:d,children:o,...m}=e;return(0,r.jsxs)("button",{ref:t,className:"\n          inline-flex items-center justify-center font-medium rounded-md\n          transition-colors duration-200\n          focus:outline-none focus:ring-2 focus:ring-offset-2\n          disabled:opacity-50 disabled:cursor-not-allowed\n          ".concat(i[s],"\n          ").concat(n[l],"\n          ").concat(a,"\n        "),disabled:d||c,...m,children:[c&&(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o]})});function c(e){let{children:t,className:a="",title:s,subtitle:i}=e;return(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-card border border-gray-200 dark:border-gray-700 transition-colors ".concat(a),children:[(s||i)&&(0,r.jsxs)("div",{className:"px-6 py-5 border-b border-gray-200 dark:border-gray-700",children:[s&&(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white leading-tight",children:s}),i&&(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1.5 leading-relaxed",children:i})]}),(0,r.jsx)("div",{className:"p-6",children:t})]})}function d(e){let{onSubmit:t,isLoading:a}=e,[i,n]=(0,s.useState)(""),[d,o]=(0,s.useState)(""),[m,x]=(0,s.useState)({});return(0,r.jsx)(c,{title:"Dados para Compara\xe7\xe3o",subtitle:"Informe a URL do carrinho VTEX e o ID do or\xe7amento",children:(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{let e={};return i.trim()||(e.orderFormUrl="URL do carrinho \xe9 obrigat\xf3ria"),d.trim()||(e.idBudget="ID do or\xe7amento \xe9 obrigat\xf3rio"),x(e),0===Object.keys(e).length})()&&t({orderFormUrl:i.trim(),idBudget:d.trim()})},className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"orderFormUrl",className:"block text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"URL do Carrinho / OrderFormId"}),(0,r.jsx)("input",{type:"text",id:"orderFormUrl",value:i,onChange:e=>n(e.target.value),placeholder:"https://www.loja.com.br/checkout/?orderFormId=abc123 ou abc123",className:"\n              w-full px-4 py-3 rounded-md border text-base transition-colors\n              bg-white dark:bg-gray-800\n              text-gray-900 dark:text-white\n              placeholder-gray-400 dark:placeholder-gray-500\n              focus:outline-none focus:ring-2 focus:ring-green-main\n              ".concat(m.orderFormUrl?"border-status-error focus:ring-status-error":"border-gray-300 dark:border-gray-600","\n            ")}),m.orderFormUrl&&(0,r.jsx)("p",{className:"mt-2 text-sm font-medium text-status-error",children:m.orderFormUrl}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"Cole a URL completa do checkout ou apenas o orderFormId"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"idBudget",className:"block text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"ID do Or\xe7amento"}),(0,r.jsx)("input",{type:"text",id:"idBudget",value:d,onChange:e=>o(e.target.value),placeholder:"12345",className:"\n              w-full px-4 py-3 rounded-md border text-base transition-colors\n              bg-white dark:bg-gray-800\n              text-gray-900 dark:text-white\n              placeholder-gray-400 dark:placeholder-gray-500\n              focus:outline-none focus:ring-2 focus:ring-green-main\n              ".concat(m.idBudget?"border-status-error focus:ring-status-error":"border-gray-300 dark:border-gray-600","\n            ")}),m.idBudget&&(0,r.jsx)("p",{className:"mt-2 text-sm font-medium text-status-error",children:m.idBudget}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"ID do or\xe7amento armazenado no Master Data"})]}),(0,r.jsx)("div",{className:"pt-4",children:(0,r.jsx)(l,{type:"submit",isLoading:a,className:"w-full",size:"lg",children:a?"Comparando...":"Comparar"})})]})})}l.displayName="Button";let o={default:"bg-grey-medium/20 text-grey-dark",success:"bg-green-main/15 text-green-main",warning:"bg-brand-yellow/15 text-[#b38600]",error:"bg-status-error/15 text-status-error",info:"bg-brand-cyan/15 text-brand-cyan"};function m(e){let{children:t,variant:a="default",className:s=""}=e;return(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-md text-xs font-medium ".concat(o[a]," ").concat(s),children:t})}let x={none:{label:"OK",variant:"success"},low:{label:"Baixo",variant:"info"},medium:{label:"M\xe9dio",variant:"warning"},high:{label:"Alto",variant:"error"},critical:{label:"Cr\xedtico",variant:"error"}};function h(e){let{impact:t,className:a=""}=e,s=x[t];return(0,r.jsx)(m,{variant:s.variant,className:a,children:s.label})}let u={match:{label:"Igual",variant:"success"},quantity_diff:{label:"Qtd Diferente",variant:"warning"},price_diff:{label:"Pre\xe7o Diferente",variant:"warning"},quantity_price_diff:{label:"Qtd e Pre\xe7o Dif.",variant:"error"},missing_in_cart:{label:"Falta no Carrinho",variant:"error"},unexpected_in_cart:{label:"Extra no Carrinho",variant:"error"}};function f(e){let{status:t,className:a=""}=e,s=u[t];return(0,r.jsx)(m,{variant:s.variant,className:a,children:s.label})}function g(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function b(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,a=e>0?"+":"";return"".concat(a).concat(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return new Intl.NumberFormat("pt-BR",{minimumFractionDigits:t,maximumFractionDigits:t}).format(e)}(e,t),"%")}function p(e){let t=e.replace(/\D/g,"");return 8!==t.length?e:"".concat(t.slice(0,5),"-").concat(t.slice(5))}function j(e){let{summary:t,totalsDiff:a}=e;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(c,{children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-brand-black dark:text-white",children:"Resultado da Compara\xe7\xe3o"}),(0,r.jsx)("p",{className:"text-base text-brand-black/70 dark:text-white/70 mt-2",children:0===t.totalDiffs?"Nenhuma diverg\xeancia encontrada":"".concat(t.totalDiffs," diverg\xeancia(s) encontrada(s)")})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(h,{impact:t.overallImpact,className:"text-sm px-4 py-1.5"}),0!==t.financialImpact&&(0,r.jsxs)("div",{className:"text-xl font-bold ".concat(t.financialImpact>0?"text-status-error":"text-green-main"),children:[t.financialImpact>0?"+":"",g(t.financialImpact)]})]})]}),t.totalDiffs>0&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-6 mt-5 pt-5 border-t border-grey-medium/20",children:[t.criticalDiffs>0&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"w-3 h-3 rounded-full bg-status-error"}),(0,r.jsxs)("span",{className:"text-sm font-medium text-brand-black/80 dark:text-white/80",children:[t.criticalDiffs," cr\xedtica(s)"]})]}),t.highDiffs>0&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"w-3 h-3 rounded-full bg-brand-yellow"}),(0,r.jsxs)("span",{className:"text-sm font-medium text-brand-black/80 dark:text-white/80",children:[t.highDiffs," alta(s)"]})]}),t.mediumDiffs>0&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"w-3 h-3 rounded-full bg-brand-yellow/60"}),(0,r.jsxs)("span",{className:"text-sm font-medium text-brand-black/80 dark:text-white/80",children:[t.mediumDiffs," m\xe9dia(s)"]})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(c,{title:"Or\xe7amento",className:"border-l-4 border-brand-cyan",children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(v,{label:"Subtotal",value:a.subtotal.budget}),(0,r.jsx)(v,{label:"Descontos",value:-a.discounts.budget,isNegative:!0}),(0,r.jsx)(v,{label:"Frete",value:a.shipping.budget}),(0,r.jsx)(v,{label:"Impostos",value:a.taxes.budget}),(0,r.jsx)("div",{className:"pt-3 border-t border-grey-medium/20",children:(0,r.jsx)(v,{label:"Total",value:a.total.budget,isTotal:!0})})]})}),(0,r.jsx)(c,{title:"Carrinho",className:"border-l-4 border-green-main",children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(v,{label:"Subtotal",value:a.subtotal.cart,diff:a.subtotal.diff,diffPct:a.subtotal.diffPct}),(0,r.jsx)(v,{label:"Descontos",value:-a.discounts.cart,diff:-a.discounts.diff,diffPct:a.discounts.diffPct,isNegative:!0}),(0,r.jsx)(v,{label:"Frete",value:a.shipping.cart,diff:a.shipping.diff,diffPct:a.shipping.diffPct}),(0,r.jsx)(v,{label:"Impostos",value:a.taxes.cart,diff:a.taxes.diff,diffPct:a.taxes.diffPct}),(0,r.jsx)("div",{className:"pt-3 border-t border-grey-medium/20",children:(0,r.jsx)(v,{label:"Total",value:a.total.cart,diff:a.total.diff,diffPct:a.total.diffPct,isTotal:!0})})]})})]}),a.explanation&&(0,r.jsx)("div",{className:"p-4 bg-brand-yellow/10 border border-brand-yellow/30 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-brand-black/80 dark:text-white/80 leading-relaxed",children:[(0,r.jsx)("strong",{className:"text-brand-black dark:text-white",children:"An\xe1lise:"})," ",a.explanation]})})]})}function v(e){let{label:t,value:a,diff:s,diffPct:i,isTotal:n,isNegative:l}=e,c=void 0!==s&&Math.abs(s)>.01;return(0,r.jsxs)("div",{className:"flex justify-between items-center py-1 ".concat(n?"font-bold text-lg":"text-base"),children:[(0,r.jsx)("span",{className:"text-brand-black/70 dark:text-white/70",children:t}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("span",{className:"font-medium ".concat(l&&0!==a?"text-green-main":"text-brand-black dark:text-white"),children:g(a)}),c&&(0,r.jsxs)("span",{className:"ml-2 text-sm font-medium ".concat(s>0?"text-status-error":"text-green-main"),children:["(",b(i),")"]})]})]})}function N(e){let{children:t,className:a=""}=e;return(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsx)("table",{className:"min-w-full divide-y divide-grey-medium/20 ".concat(a),children:t})})}function y(e){let{children:t,className:a=""}=e;return(0,r.jsx)("thead",{className:"bg-brand-black text-white ".concat(a),children:t})}function k(e){let{children:t,className:a=""}=e;return(0,r.jsx)("tbody",{className:"bg-white dark:bg-brand-black/30 divide-y divide-grey-medium/20 ".concat(a),children:t})}function w(e){let{children:t,className:a="",onClick:s}=e;return(0,r.jsx)("tr",{className:"hover:bg-row-hover transition-colors ".concat(s?"cursor-pointer":""," ").concat(a),onClick:s,children:t})}function D(e){let{children:t,className:a="",align:s="left"}=e;return(0,r.jsx)("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wider ".concat({left:"text-left",center:"text-center",right:"text-right"}[s]," ").concat(a),children:t})}function C(e){let{children:t,className:a="",align:s="left",colSpan:i}=e;return(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-brand-black dark:text-white ".concat({left:"text-left",center:"text-center",right:"text-right"}[s]," ").concat(a),colSpan:i,children:t})}function I(e){let{itemDiffs:t}=e,[a,i]=(0,s.useState)("all"),[n,l]=(0,s.useState)(null),d=t.filter(e=>"all"===a||("divergent"===a?"match"!==e.status:"critical"!==a||"critical"===e.impact||"high"===e.impact)),o=t.filter(e=>"match"!==e.status).length,m=t.filter(e=>"critical"===e.impact||"high"===e.impact).length;return(0,r.jsxs)(c,{children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-brand-black dark:text-white",children:"Compara\xe7\xe3o de Itens"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(F,{active:"all"===a,onClick:()=>i("all"),count:t.length,children:"Todos"}),(0,r.jsx)(F,{active:"divergent"===a,onClick:()=>i("divergent"),count:o,children:"Divergentes"}),(0,r.jsx)(F,{active:"critical"===a,onClick:()=>i("critical"),count:m,children:"Cr\xedticos"})]})]}),0===d.length?(0,r.jsx)("div",{className:"text-center py-8 text-grey-medium",children:"all"===a?"Nenhum item para comparar":"Nenhum item corresponde ao filtro selecionado"}):(0,r.jsxs)(N,{children:[(0,r.jsx)(y,{children:(0,r.jsxs)(w,{children:[(0,r.jsx)(D,{children:"SKU"}),(0,r.jsx)(D,{children:"Nome"}),(0,r.jsx)(D,{align:"center",children:"Qtd Or\xe7."}),(0,r.jsx)(D,{align:"center",children:"Qtd Cart."}),(0,r.jsx)(D,{align:"right",children:"Pre\xe7o Or\xe7."}),(0,r.jsx)(D,{align:"right",children:"Pre\xe7o Cart."}),(0,r.jsx)(D,{align:"center",children:"Status"}),(0,r.jsx)(D,{align:"center",children:"Impacto"})]})}),(0,r.jsx)(k,{children:d.map(e=>{var t,a;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(w,{className:function(e){switch(e){case"critical":return"bg-status-error/5";case"high":return"bg-brand-yellow/10";case"medium":return"bg-brand-yellow/5";case"low":return"bg-brand-cyan/5";default:return""}}(e.impact),onClick:()=>l(n===e.skuId?null:e.skuId),children:[(0,r.jsx)(C,{className:"font-mono text-xs",children:e.skuId}),(0,r.jsx)(C,{className:"max-w-[200px] truncate",children:e.name}),(0,r.jsx)(C,{align:"center",children:null!=(t=e.budgetQty)?t:"-"}),(0,r.jsxs)(C,{align:"center",children:[null!=(a=e.cartQty)?a:"-",void 0!==e.qtyDiffAbs&&0!==e.qtyDiffAbs&&(0,r.jsxs)("span",{className:"ml-1 text-xs ".concat(e.qtyDiffAbs>0?"text-status-error":"text-green-main"),children:["(",e.qtyDiffAbs>0?"+":"",e.qtyDiffAbs,")"]})]}),(0,r.jsx)(C,{align:"right",children:void 0!==e.budgetPrice?g(e.budgetPrice):"-"}),(0,r.jsxs)(C,{align:"right",children:[void 0!==e.cartPrice?g(e.cartPrice):"-",void 0!==e.priceDiffPct&&Math.abs(e.priceDiffPct)>.01&&(0,r.jsxs)("span",{className:"ml-1 text-xs ".concat(e.priceDiffPct>0?"text-status-error":"text-green-main"),children:["(",b(e.priceDiffPct),")"]})]}),(0,r.jsx)(C,{align:"center",children:(0,r.jsx)(f,{status:e.status})}),(0,r.jsx)(C,{align:"center",children:(0,r.jsx)(h,{impact:e.impact})})]},e.skuId),n===e.skuId&&e.explanation&&(0,r.jsx)(w,{children:(0,r.jsx)(C,{colSpan:8,className:"bg-card-bg",children:(0,r.jsx)("div",{className:"py-2 px-4",children:(0,r.jsxs)("p",{className:"text-sm text-grey-dark",children:[(0,r.jsx)("strong",{className:"text-brand-black",children:"Detalhes:"})," ",e.explanation]})})})},"".concat(e.skuId,"-detail"))]})})})]})]})}function F(e){let{children:t,active:a,onClick:s,count:i}=e;return(0,r.jsxs)("button",{onClick:s,className:"\n        px-3 py-1.5 rounded-md text-sm font-medium transition-colors\n        ".concat(a?"bg-green-main text-white":"bg-card-bg text-grey-dark hover:bg-grey-medium/20","\n      "),children:[t," (",i,")"]})}function P(e){let{promoDiffs:t}=e;if(0===t.length)return null;let a=t.some(e=>"match"!==e.status);return(0,r.jsxs)(c,{title:"Promo\xe7\xf5es e Benef\xedcios",subtitle:"".concat(t.length," promo\xe7\xe3o(\xf5es) analisada(s)"),children:[(0,r.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,r.jsxs)("div",{className:"\n              p-4 rounded-lg border\n              ".concat("match"===e.status?"bg-green-main/5 border-green-main/20":"only_in_budget"===e.status?"bg-status-error/5 border-status-error/20":"only_in_cart"===e.status?"bg-brand-cyan/5 border-brand-cyan/20":"bg-brand-yellow/5 border-brand-yellow/20","\n            "),children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"font-medium text-brand-black dark:text-white",children:e.name}),(0,r.jsx)(S,{status:e.status})]}),(0,r.jsxs)("p",{className:"text-xs text-grey-medium mt-1 font-mono",children:["ID: ",e.id]})]}),(0,r.jsx)("div",{className:"flex items-center gap-3",children:(0,r.jsx)(h,{impact:e.impact})})]}),(0,r.jsxs)("div",{className:"mt-3 flex flex-wrap gap-4 text-sm",children:[void 0!==e.budgetValue&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-grey-medium",children:"Or\xe7amento: "}),(0,r.jsx)("span",{className:"font-medium text-brand-black",children:g(e.budgetValue)})]}),void 0!==e.cartValue&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-grey-medium",children:"Carrinho: "}),(0,r.jsx)("span",{className:"font-medium text-brand-black",children:g(e.cartValue)})]}),void 0!==e.valueDiff&&Math.abs(e.valueDiff)>.01&&(0,r.jsxs)("div",{className:e.valueDiff>0?"text-green-main":"text-status-error",children:[(0,r.jsx)("span",{className:"text-grey-medium",children:"Diferen\xe7a: "}),(0,r.jsxs)("span",{className:"font-medium",children:[e.valueDiff>0?"+":"",g(e.valueDiff)]})]})]}),e.explanation&&(0,r.jsx)("p",{className:"mt-2 text-sm text-grey-dark",children:e.explanation})]},e.id))}),!a&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-green-main/5 rounded-lg",children:(0,r.jsx)("p",{className:"text-sm text-green-main",children:"Todas as promo\xe7\xf5es est\xe3o alinhadas entre or\xe7amento e carrinho."})})]})}function S(e){let{status:t}=e,{label:a,variant:s}={match:{label:"Aplicada",variant:"success"},only_in_budget:{label:"N\xe3o aplicada",variant:"error"},only_in_cart:{label:"Extra",variant:"info"},value_diff:{label:"Valor diferente",variant:"warning"}}[t];return(0,r.jsx)(m,{variant:s,children:a})}function O(e){let{shippingDiff:t}=e;if(!t)return(0,r.jsx)(c,{title:"Dados de Entrega",children:(0,r.jsx)("p",{className:"text-grey-medium text-center py-4",children:"Sem dados de entrega para comparar"})});let a=t.postalCodeDiff||t.deliveryTypeDiff||Math.abs(t.shippingValueDiff.diff)>.01;return(0,r.jsxs)(c,{title:"Dados de Entrega",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-[#3c3c3b] dark:text-white",children:"Status da compara\xe7\xe3o"}),(0,r.jsx)(h,{impact:t.impact})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"p-4 rounded-lg ".concat(t.postalCodeDiff?"bg-status-error/5":"bg-green-main/5"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-[#3c3c3b] dark:text-white",children:"CEP"}),t.postalCodeDiff?(0,r.jsx)(m,{variant:"error",children:"Diferente"}):(0,r.jsx)(m,{variant:"success",children:"Igual"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-[#575756] dark:text-white/80 block mb-1",children:"Or\xe7amento:"}),(0,r.jsx)("p",{className:"font-mono font-semibold text-base text-[#3c3c3b] dark:text-white",children:t.budgetPostalCode?p(t.budgetPostalCode):"-"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-[#575756] dark:text-white/80 block mb-1",children:"Carrinho:"}),(0,r.jsx)("p",{className:"font-mono font-semibold text-base text-[#3c3c3b] dark:text-white",children:t.cartPostalCode?p(t.cartPostalCode):"-"})]})]})]}),(0,r.jsxs)("div",{className:"p-4 rounded-lg ".concat(t.deliveryTypeDiff?"bg-brand-yellow/10":"bg-green-main/5"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-[#3c3c3b] dark:text-white",children:"Tipo de Entrega"}),t.deliveryTypeDiff?(0,r.jsx)(m,{variant:"warning",children:"Diferente"}):(0,r.jsx)(m,{variant:"success",children:"Igual"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-[#575756] dark:text-white/80 block mb-1",children:"Or\xe7amento:"}),(0,r.jsx)("p",{className:"font-semibold text-base text-[#3c3c3b] dark:text-white",children:t.budgetDeliveryType||"-"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-[#575756] dark:text-white/80 block mb-1",children:"Carrinho:"}),(0,r.jsx)("p",{className:"font-semibold text-base text-[#3c3c3b] dark:text-white",children:t.cartDeliveryType||"-"})]})]})]})]}),(0,r.jsxs)("div",{className:"mt-4 p-4 rounded-lg ".concat(Math.abs(t.shippingValueDiff.diff)>.01?"bg-brand-yellow/10":"bg-green-main/5"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-[#3c3c3b] dark:text-white",children:"Valor do Frete"}),Math.abs(t.shippingValueDiff.diff)>.01?(0,r.jsx)(m,{variant:"warning",children:t.shippingValueDiff.diff>0?"Maior no carrinho":"Menor no carrinho"}):(0,r.jsx)(m,{variant:"success",children:"Igual"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-[#575756] dark:text-white/80 block mb-1",children:"Or\xe7amento:"}),(0,r.jsx)("p",{className:"font-bold text-lg text-[#3c3c3b] dark:text-white",children:g(t.shippingValueDiff.budget)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-[#575756] dark:text-white/80 block mb-1",children:"Carrinho:"}),(0,r.jsx)("p",{className:"font-bold text-lg text-[#3c3c3b] dark:text-white",children:g(t.shippingValueDiff.cart)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-[#575756] dark:text-white/80 block mb-1",children:"Diferen\xe7a:"}),(0,r.jsxs)("p",{className:"font-bold text-lg ".concat(t.shippingValueDiff.diff>0?"text-status-error":t.shippingValueDiff.diff<0?"text-green-main":"text-[#3c3c3b] dark:text-white"),children:[0!==t.shippingValueDiff.diff&&(0,r.jsxs)(r.Fragment,{children:[t.shippingValueDiff.diff>0?"+":"",g(t.shippingValueDiff.diff),(0,r.jsxs)("span",{className:"text-sm ml-1",children:["(",b(t.shippingValueDiff.diffPct),")"]})]}),0===t.shippingValueDiff.diff&&"-"]})]})]})]}),t.explanation&&(0,r.jsx)("div",{className:"mt-4 p-4 bg-brand-yellow/10 border border-brand-yellow/30 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-[#3c3c3b] dark:text-white leading-relaxed",children:[(0,r.jsx)("strong",{children:"An\xe1lise:"})," ",t.explanation]})}),!a&&(0,r.jsx)("div",{className:"mt-4 p-4 bg-green-main/5 rounded-lg",children:(0,r.jsx)("p",{className:"text-sm font-medium text-green-main",children:"Dados de entrega alinhados entre or\xe7amento e carrinho."})})]})}function _(){return(0,r.jsxs)(c,{title:"Legenda",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-bold text-[#3c3c3b] dark:text-white mb-4 text-base",children:"N\xedveis de Criticidade"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(R,{color:"bg-status-error",label:"Cr\xedtico",description:"Diverg\xeancia que pode impedir fechamento do pedido ou causar grande preju\xedzo"}),(0,r.jsx)(R,{color:"bg-brand-yellow",label:"Alto",description:"Diverg\xeancia significativa com impacto financeiro consider\xe1vel"}),(0,r.jsx)(R,{color:"bg-brand-yellow/60",label:"M\xe9dio",description:"Diverg\xeancia moderada que requer aten\xe7\xe3o"}),(0,r.jsx)(R,{color:"bg-brand-cyan",label:"Baixo",description:"Diverg\xeancia menor, sem impacto financeiro significativo"}),(0,r.jsx)(R,{color:"bg-green-main",label:"OK",description:"Sem diverg\xeancia, valores alinhados"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-bold text-[#3c3c3b] dark:text-white mb-4 text-base",children:"Status de Itens"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(V,{label:"Igual",description:"Item id\xeantico em or\xe7amento e carrinho"}),(0,r.jsx)(V,{label:"Qtd Diferente",description:"Quantidade do item difere entre or\xe7amento e carrinho"}),(0,r.jsx)(V,{label:"Pre\xe7o Diferente",description:"Pre\xe7o unit\xe1rio do item difere"}),(0,r.jsx)(V,{label:"Falta no Carrinho",description:"Item est\xe1 no or\xe7amento mas n\xe3o foi adicionado ao carrinho"}),(0,r.jsx)(V,{label:"Extra no Carrinho",description:"Item no carrinho que n\xe3o constava no or\xe7amento"})]})]})]}),(0,r.jsx)("div",{className:"mt-6 pt-4 border-t border-grey-medium/20",children:(0,r.jsxs)("p",{className:"text-sm text-[#575756] dark:text-white/80 leading-relaxed",children:[(0,r.jsx)("strong",{className:"text-[#3c3c3b] dark:text-white",children:"Nota:"})," Os thresholds de criticidade podem ser configurados via vari\xe1veis de ambiente. Por padr\xe3o, diferen\xe7as acima de 0.5% ou R$ 50,00 s\xe3o marcadas como cr\xedticas."]})})]})}function R(e){let{color:t,label:a,description:s}=e;return(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"w-3 h-3 rounded-full ".concat(t," mt-1.5 flex-shrink-0")}),(0,r.jsxs)("div",{className:"leading-relaxed",children:[(0,r.jsxs)("span",{className:"font-semibold text-[#3c3c3b] dark:text-white",children:[a,":"]}),(0,r.jsx)("span",{className:"text-[#575756] dark:text-white/80 ml-1",children:s})]})]})}function V(e){let{label:t,description:a}=e;return(0,r.jsxs)("div",{className:"leading-relaxed",children:[(0,r.jsxs)("span",{className:"font-semibold text-[#3c3c3b] dark:text-white",children:[t,":"]}),(0,r.jsx)("span",{className:"text-[#575756] dark:text-white/80 ml-1",children:a})]})}function T(){let[e,t]=(0,s.useState)("input"),[a,i]=(0,s.useState)(null),[n,c]=(0,s.useState)(null),o=async e=>{t("loading"),c(null);try{let a=await fetch("/api/compare",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await a.json();if(!a.ok){c(r),t("error");return}i(r),t("result")}catch(e){c({error:"NETWORK_ERROR",message:"Erro de conex\xe3o. Verifique sua internet e tente novamente.",details:e instanceof Error?e.message:"Erro desconhecido"}),t("error")}},m=()=>{t("input"),i(null),c(null)};return(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Comparar Or\xe7amento vs Carrinho"}),(0,r.jsx)("p",{className:"text-base text-gray-600 dark:text-gray-300 mt-2",children:"Cole o link do carrinho VTEX e o ID do or\xe7amento para comparar"})]}),"result"===e&&(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(l,{variant:"outline",onClick:()=>{if(!a)return;let e=[];for(let c of(e.push("VTEX Budget Audit - Relat\xf3rio de Compara\xe7\xe3o"),e.push("Data: ".concat(new Date(a.metadata.comparedAt).toLocaleString("pt-BR"))),e.push("OrderForm ID: ".concat(a.metadata.orderFormId)),e.push("Budget ID: ".concat(a.metadata.budgetId)),e.push(""),e.push("=== RESUMO ==="),e.push("Total de diverg\xeancias: ".concat(a.summary.totalDiffs)),e.push("Diverg\xeancias cr\xedticas: ".concat(a.summary.criticalDiffs)),e.push("Impacto financeiro: R$ ".concat(a.summary.financialImpact.toFixed(2))),e.push(""),e.push("=== TOTAIS ==="),e.push("Campo,Or\xe7amento,Carrinho,Diferen\xe7a"),e.push("Subtotal,".concat(a.totalsDiff.subtotal.budget.toFixed(2),",").concat(a.totalsDiff.subtotal.cart.toFixed(2),",").concat(a.totalsDiff.subtotal.diff.toFixed(2))),e.push("Descontos,".concat(a.totalsDiff.discounts.budget.toFixed(2),",").concat(a.totalsDiff.discounts.cart.toFixed(2),",").concat(a.totalsDiff.discounts.diff.toFixed(2))),e.push("Frete,".concat(a.totalsDiff.shipping.budget.toFixed(2),",").concat(a.totalsDiff.shipping.cart.toFixed(2),",").concat(a.totalsDiff.shipping.diff.toFixed(2))),e.push("Total,".concat(a.totalsDiff.total.budget.toFixed(2),",").concat(a.totalsDiff.total.cart.toFixed(2),",").concat(a.totalsDiff.total.diff.toFixed(2))),e.push(""),e.push("=== ITENS ==="),e.push("SKU,Nome,Qtd Or\xe7,Qtd Cart,Pre\xe7o Or\xe7,Pre\xe7o Cart,Status,Impacto"),a.itemDiffs)){var t,r,s,i,n,l;e.push("".concat(c.skuId,',"').concat(c.name,'",').concat(null!=(s=c.budgetQty)?s:"",",").concat(null!=(i=c.cartQty)?i:"",",").concat(null!=(n=null==(t=c.budgetPrice)?void 0:t.toFixed(2))?n:"",",").concat(null!=(l=null==(r=c.cartPrice)?void 0:r.toFixed(2))?l:"",",").concat(c.status,",").concat(c.impact))}let c=new Blob([e.join("\n")],{type:"text/csv;charset=utf-8;"}),d=URL.createObjectURL(c),o=document.createElement("a");o.href=d,o.download="comparacao_".concat(a.metadata.orderFormId,"_").concat(Date.now(),".csv"),o.click(),URL.revokeObjectURL(d)},children:"Exportar CSV"}),(0,r.jsx)(l,{variant:"secondary",onClick:m,children:"Nova Compara\xe7\xe3o"})]})]}),("input"===e||"loading"===e)&&(0,r.jsx)(d,{onSubmit:o,isLoading:"loading"===e}),"error"===e&&n&&(0,r.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-red-700 dark:text-red-400 mb-2",children:"Erro na Compara\xe7\xe3o"}),(0,r.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:n.message}),void 0!==n.details&&(0,r.jsx)("pre",{className:"bg-red-100 dark:bg-red-900/40 p-3 rounded-md text-sm text-red-700 dark:text-red-300 overflow-x-auto",children:"string"==typeof n.details?n.details:JSON.stringify(n.details,null,2)}),n.requestId&&(0,r.jsxs)("p",{className:"mt-4 text-xs text-gray-500 dark:text-gray-400",children:["Request ID: ",n.requestId]}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(l,{onClick:m,children:"Tentar Novamente"})})]}),"result"===e&&a&&(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsx)(j,{summary:a.summary,totalsDiff:a.totalsDiff}),(0,r.jsx)(I,{itemDiffs:a.itemDiffs}),a.promoDiffs.length>0&&(0,r.jsx)(P,{promoDiffs:a.promoDiffs}),(0,r.jsx)(O,{shippingDiff:a.shippingDiff}),(0,r.jsx)(_,{}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:["Compara\xe7\xe3o realizada em"," ",new Date(a.metadata.comparedAt).toLocaleString("pt-BR")," | ","Request ID: ",a.metadata.requestId]})]})]})}},6155:(e,t,a)=>{Promise.resolve().then(a.bind(a,4223))}},e=>{e.O(0,[441,255,358],()=>e(e.s=6155)),_N_E=e.O()}]);